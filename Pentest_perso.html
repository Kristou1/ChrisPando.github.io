<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Projet 3 : Script de pentest personnalisé</title>
    <!-- Lien vers le style pour la coloration syntaxique -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.25.0/themes/prism-tomorrow.min.css" rel="stylesheet" />
    <style>
        body {
            font-family: 'Roboto', sans-serif;
            margin: 20px;
            padding: 20px;
            background-color: #f4f4f4;
            color: #333;
        }

        h1 {
            text-align: center;
        }

        pre {
            background-color: #2d2d2d;
            padding: 20px;
            border-radius: 8px;
            color: #fff;
        }
    </style>
</head>
<body>
    <h1>Projet 3 : Script de pentest personnalisé</h1>
    <pre><code class="language-bash">
      
#!/bin/bash

: << 'EOF'
Ce script de pentesting utilise les outils suivants :
- sslscan : pour scanner les configurations SSL/TLS.
- whatweb : pour identifier les technologies web utilisées par la cible.
- amass : pour l'énumération de sous-domaines.
- nmap : pour la reconnaissance réseau et la détection des services.
- subfinder : pour découvrir des sous-domaines associés à une cible.
- httprobe : pour tester rapidement les sous-domaines avec services HTTP/HTTPS.
- gowitness/aquatone : pour capturer des captures d'écran des interfaces web.
EOF

# Vérification des paramètres d'entrée
if [ -z "$1" ]; then
    echo "Usage: $0 <target>"
    exit 1
fi

# Fonction pour afficher les en-têtes de section
function print_tool() {
    echo "********************************************"
    echo "$1"
    echo "********************************************"
}

# Variables
target=$1
timestamp=$(date +%Y%m%d_%H%M%S)
output_dir="Results_${target}_${timestamp}"
mkdir -p "$output_dir"

sslscan_output="${output_dir}/sslscan_${target}.txt"
whatweb_output="${output_dir}/whatweb_${target}.txt"
amass_output="${output_dir}/amass_${target}.txt"
nmap_output="${output_dir}/nmap_${target}.txt"
subfinder_output="${output_dir}/subfinder_${target}.txt"
httprobe_output="${output_dir}/httprobe_${target}.txt"

# Affichage de l'entête
echo "Mon outil de scan v0.3" | tee -a "$output_dir/Resultat.txt"
echo "Scan pour : $target" | tee -a "$output_dir/Resultat.txt"
echo "Date : $(date)" | tee -a "$output_dir/Resultat.txt"

# Lancement de sslscan
print_tool "sslscan" | tee -a "$output_dir/Resultat.txt"
if command -v sslscan &> /dev/null; then
    sslscan --no-failed "$target" | tee -a "$sslscan_output"
else
    echo "sslscan n'est pas installé ou disponible dans le PATH." | tee -a "$output_dir/Resultat.txt"
fi

# Lancement de whatweb
print_tool "whatweb" | tee -a "$output_dir/Resultat.txt"
if command -v whatweb &> /dev/null; then
    whatweb "$target" | tee -a "$whatweb_output"
else
    echo "whatweb n'est pas installé ou disponible dans le PATH." | tee -a "$output_dir/Resultat.txt"
fi

# Lancement de amass
print_tool "amass" | tee -a "$output_dir/Resultat.txt"
if command -v amass &> /dev/null; then
    amass enum -d "$target" -max-depth 2 -timeout 1 | tee -a "$amass_output"
else
    echo "amass n'est pas installé ou disponible dans le PATH." | tee -a "$output_dir/Resultat.txt"
fi

# Lancement de nmap
print_tool "nmap" | tee -a "$output_dir/Resultat.txt"
if command -v nmap &> /dev/null; then
    nmap -sV -Pn "$target" | tee -a "$nmap_output"
else
    echo "nmap n'est pas installé ou disponible dans le PATH." | tee -a "$output_dir/Resultat.txt"
fi

# Lancement de subfinder pour découvrir des sous-domaines
print_tool "subfinder" | tee -a "$output_dir/Resultat.txt"
if command -v subfinder &> /dev/null; then
    subfinder -d "$target" -silent | tee -a "$subfinder_output"
else
    echo "subfinder n'est pas installé ou disponible dans le PATH." | tee -a "$output_dir/Resultat.txt"
fi

# Lancement de httprobe pour tester les sous-domaines
if [ -f "$subfinder_output" ]; then
    print_tool "httprobe" | tee -a "$output_dir/Resultat.txt"
    if command -v httprobe &> /dev/null; then
        cat "$subfinder_output" | httprobe | tee -a "$httprobe_output"
    else
        echo "httprobe n'est pas installé ou disponible dans le PATH." | tee -a "$output_dir/Resultat.txt"
    fi
fi

# Optionnel: Capture d'écran des interfaces web avec gowitness ou aquatone
print_tool "Capture d'écran avec gowitness/aquatone" | tee -a "$output_dir/Resultat.txt"
if command -v gowitness &> /dev/null; then
    gowitness file -f "$httprobe_output" --destination "$output_dir/gowitness_screenshots" | tee -a "$output_dir/Resultat.txt"
elif command -v aquatone &> /dev/null; then
    cat "$httprobe_output" | aquatone -out "$output_dir/aquatone_screenshots" | tee -a "$output_dir/Resultat.txt"
else
    echo "gowitness ou aquatone n'est pas installé ou disponible dans le PATH." | tee -a "$output_dir/Resultat.txt"
fi

# Fin du script
echo "Scan terminé. Les résultats sont enregistrés dans le dossier $output_dir."i

import socket

def scan_ports(target, ports):
    for port in ports:
        sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        sock.settimeout(1)
        result = sock.connect_ex((target, port))
        if result == 0:
            print(f"Port {port} is open")
        else:
            print(f"Port {port} is closed")
        sock.close()
    </code></pre>

    <!-- Lien vers Prism.js pour la coloration syntaxique -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.25.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.25.0/components/prism-python.min.js"></script>
</body>
</html>
